{% extends 'store/main.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="/static/css/views.css">
<!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"> -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
  <!-- <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"> -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"><div class="pd-wrap">
    <div class="container">
        {% for i in Items %}
          <div class="heading-section">
              <h2>Product Details</h2>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div id="slider" class="owl-carousel product-slider">
                <div class="item">
                    <!-- <img style="width: 100%;" src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80" /> -->
                    <img style="width: 100%;" src="{{i.product.imageURL}}" />
                </div>
            </div>
            </div>
            <div class="col-md-6">
              <div class="product-dtl">
                <div class="product-info">
                  <div class="product-name">{{i.product.name}}</div>
                   <div class="reviews-counter">
                    <!-- <div class="rate">
                        <input type="radio" id="star5" name="rate" value="5" checked />
                        <label for="star5" title="text">5 stars</label>
                        <input type="radio" id="star4" name="rate" value="4" checked />
                        <label for="star4" title="text">4 stars</label>
                        <input type="radio" id="star3" name="rate" value="3" checked />
                        <label for="star3" title="text">3 stars</label>
                        <input type="radio" id="star2" name="rate" value="2" />
                        <label for="star2" title="text">2 stars</label>
                        <input type="radio" id="star1" name="rate" value="1" />
                        <label for="star1" title="text">1 star</label>
                      </div> -->
                      <span>{% if i.product.id not in listReview %}
                        0
                    {% else %}
                        {% for key,value in listReview.items %}
                            {% if key == i.product.id %}
                                {{value}}
                            {% endif %}
                        {% endfor %}
                    {% endif %} Reviews</span>
                    </div> 
                    <!-- <span>3 Reviews</span> -->
                  <div class="product-price-discount"><span>${{i.product.price}}</span><span class="line-through">${{i.product.price}}</span></div>
                </div>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                <div class="row">
                  <div class="col-md-6">
                    <label for="size">Size</label>
                <select id="size" name="size" class="form-control">
                  <option>S</option>
                  <option>M</option>
                  <option>L</option>
                  <option>XL</option>
                </select>
                  </div>
                  <div class="col-md-6">
                    <label for="color">Color</label>
                <select id="color" name="color" class="form-control">
                  <option>Blue</option>
                  <option>Green</option>
                  <option>Red</option>
                </select>
                  </div>
                </div>
                <div class="product-count">
                  <!-- <label for="size">Quantity</label>
                  <form action="add" class="display-flex update-cart">
                  <div class="qtyminus">-</div>
                  <input type="text" name="quantity" value="1" class="qty">
                  <div class="qtyplus">+</div>
                </form> -->
                <!-- <a href="#" data-product={{i.product.id}} data-action="add" class="round-black-btn">Add to Cart</a> -->
                <button data-product={{i.product.id}} data-action="add" class="round-black-btn  update-cart">Add to Cart</button>
                </div>
              </div>
            </div>
          </div>
          <div class="product-info-tabs">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="true">Description</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="review-tab" data-toggle="tab" href="#review" role="tab" aria-controls="review" aria-selected="false">
                    Reviews 
                    {% if i.product.id not in listReview %}
                        (0)
                    {% else %}
                        {% for key,value in listReview.items %}
                            {% if key == i.product.id %}
                                ({{value}})
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </a>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
              <!-- Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam. -->
                {{i.product.description}}
            </div>
            <div class="tab-pane fade" id="review" role="tabpanel" aria-labelledby="review-tab">
                <div class="review-heading">REVIEWS
                </div>
                <form class="review-form" method="POST" action="{% url 'submit_review' i.product.id %}">
                    {% csrf_token %}
                    <div class="form-group" >
                        <label>Your rating</label>
                        <div class="reviews-counter" name="rate" id="rate">
                            <div class="rate" name='rate'>
                                <input type="radio" id="star5" name="rate" value="5" required/>
                                <label for="star5" title="text">5 stars</label>
                                <input type="radio" id="star4" name="rate" value="4" required/>
                                <label for="star4" title="text">4 stars</label>
                                <input type="radio" id="star3" name="rate" value="3" required/>
                                <label for="star3" title="text">3 stars</label>
                                <input type="radio" id="star2" name="rate" value="2" required/>
                                <label for="star2" title="text">2 stars</label>
                                <input type="radio" id="star1" name="rate" value="1" required/>
                                <label for="star1" title="text">1 star</label>
                            </div>
                        </div>
                    </div>
                    <!-- message reviews for this product  -->
                    <div class="form-group">
                        <label>Your message</label>
                        <textarea name="comment" id ="comment" class="form-control" rows="10"></textarea>
                        <br>
                    </div>
                    {% if user.is_authenticated %}
                        <input type="submit" class="round-black-btn " value="Submit Review">
                    {% else %}
                        <p>You must be logged in to review.</p>
                    {% endif %}
                </form>
                <br><br>  
                <div style="overflow: scroll;height: 300px;">
                {% csrf_token %}
                {%for rev in reviews %}
                    {% if rev.product.id == i.product.id %}
                    <div style="display: flex; flex-direction: column-reverse; margin-left: 2%; width: 700px;">
                        <p >
                            <ul><b>
                                {{rev.user.username}} - {{rev.created_at}} - REVIEW: 
                            </b> 
                                {% for i in '0123456789'|make_list %}
                                    {% if forloop.counter <= rev.rate%}
                                        <b style="color:ffc700">&#9733;</b>
                                    {% endif%}
                                {% endfor %}:
                            <li style="list-style: none;"><span >{{rev.comment}}</span></li>
                            </ul>
                        </p>
                    </div>
                    {% endif%}
                {% empty %}   
                    <p class="mb-20">There are no reviews yet.</p>  
                {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity=" sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
{% endblock content %}